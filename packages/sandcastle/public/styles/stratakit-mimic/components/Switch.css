@layer itwinui.components {
  /*---------------------------------------------------------------------------------------------
 * Copyright (c) Bentley Systems, Incorporated. All rights reserved.
 * See LICENSE.md in the project root for license terms and full copyright notice.
 *--------------------------------------------------------------------------------------------*/
  .stratakit-mimic-switch {
    --âœ¨width: 2rem;
    --âœ¨thumb-size: 1rem;

    --âœ¨radius: 9999px;
    --âœ¨checked-translateX: 75%;
    --âœ¨pressed-scaleX: 1.75;

    --âœ¨shadow-border: 0px 0px 0px 1px var(--stratakit-color-border-shadow-base)
      inset;

    --âœ¨glow--border-hover: var(--stratakit-color-glow-hue)
      var(--stratakit-color-border-glow-base-hover-\%);
    --âœ¨glow--border-press: var(--stratakit-color-glow-hue)
      var(--stratakit-color-border-glow-base-pressed-\%);
    --âœ¨glow--border-checked: var(--stratakit-color-glow-hue)
      var(--stratakit-color-border-glow-strong-hover-\%);
    --âœ¨glow--bg-hover: var(--stratakit-color-glow-hue)
      var(--stratakit-color-bg-glow-base-hover-\%);
    --âœ¨glow--bg-checked-hover: var(--stratakit-color-glow-hue)
      var(--stratakit-color-bg-glow-strong-hover-\%);

    --âœ¨bg--default: var(--stratakit-color-bg-page-base);
    --âœ¨bg--hover: color-mix(
      in oklch,
      var(--âœ¨bg--default) 100%,
      var(--âœ¨glow--bg-hover)
    );
    --âœ¨bg--checked: var(--stratakit-color-bg-accent-base);
    --âœ¨bg--checked-hover: color-mix(
      in oklch,
      var(--âœ¨bg--checked) 100%,
      var(--âœ¨glow--bg-checked-hover)
    );

    --âœ¨border--default: var(--stratakit-color-border-neutral-base);
    --âœ¨border--hover: color-mix(
      in oklch,
      var(--âœ¨border--default) 100%,
      var(--âœ¨glow--border-hover)
    );
    --âœ¨border--pressed: color-mix(
      in oklch,
      var(--âœ¨border--default) 100%,
      var(--âœ¨glow--border-press)
    );
    --âœ¨border--checked: color-mix(
      in oklch,
      var(--âœ¨bg--checked) 100%,
      var(--âœ¨glow--border-checked)
    );
    --âœ¨border--disabled: var(
      --stratakit-color-border-glow-on-surface-disabled
    );

    @layer base {
      appearance: none;
      border: 1px solid transparent;
      cursor: pointer;

      display: inline-grid;
      align-items: center;

      position: relative;
      border-radius: var(--âœ¨radius);
      inline-size: var(--âœ¨width);
      block-size: auto; /* Necessary to override iOS Safari UA styles */

      background-color: var(--ğŸŒ€switch-state--default, var(--âœ¨bg--default))
        var(--ğŸŒ€switch-state--hover, var(--âœ¨bg--hover))
        var(--ğŸŒ€switch-state--pressed, var(--âœ¨bg--hover))
        var(--ğŸŒ€switch-state--checked, var(--âœ¨bg--checked))
        var(--ğŸŒ€switch-state--checked-hover, var(--âœ¨bg--checked-hover))
        var(--ğŸŒ€switch-state--disabled, var(--âœ¨bg--default));
      border-color: var(--ğŸŒ€switch-state--default, var(--âœ¨border--default))
        var(--ğŸŒ€switch-state--hover, var(--âœ¨border--hover))
        var(--ğŸŒ€switch-state--pressed, var(--âœ¨border--pressed))
        var(--ğŸŒ€switch-state--checked, var(--âœ¨border--checked))
        var(--ğŸŒ€switch-state--checked-hover, var(--âœ¨border--checked))
        var(--ğŸŒ€switch-state--disabled, var(--âœ¨border--disabled));
      transition: all 150ms ease-out;
      transition-property: background-color, border-color;
      -webkit-tap-highlight-color: var(
        --stratakit-color-bg-glow-on-surface-accent-pressed
      );

      &::before,
      &::after {
        content: "";
        display: block;
        grid-area: 1 / 1 / -1 / -1;
      }

      /* This pseudo-element increases the tap target size so it's >=24px tall  */
      &::before {
        position: absolute;
        inline-size: var(--âœ¨width);
        block-size: var(--stratakit-space-x6);
        margin: -1px; /* account for border */
      }

      /* This pseudo-element creates the "thumb" */
      &::after {
        block-size: var(--âœ¨thumb-size);
        inline-size: var(--âœ¨thumb-size);
        margin: calc(0.125rem - 1px) /* sizing-2 - 1px to account for border */;
        background-color: var(--ğŸ¥switch-thumb-color);
        box-shadow:
          var(--stratakit-shadow-button-base-inset), var(--âœ¨shadow-border),
          var(--stratakit-shadow-button-base-drop);
        border-radius: var(--ğŸ¥switch-thumb-radius, var(--âœ¨radius));
        transform-origin: left;
        transform: var(--ğŸ¥switch-thumb-transform);

        @media (prefers-reduced-motion: no-preference) {
          transition: all 150ms ease-out;
          transition-property: transform, border-radius;
          will-change: transform, border-radius;
        }
      }
    }

    @layer states {
      --ğŸ¥switch-thumb-color: var(--stratakit-color-bg-neutral-inverse);

      @media (any-hover: hover) {
        &:where(:hover) {
          --ğŸŒ€switch-state: var(--ğŸŒ€switch-state--hover);
        }
      }

      &:where(:checked, [aria-checked="true"]) {
        --ğŸŒ€switch-state: var(--ğŸŒ€switch-state--checked);
        --ğŸ¥switch-thumb-transform: translateX(var(--âœ¨checked-translateX));

        @media (any-hover: hover) {
          &:where(:hover) {
            --ğŸŒ€switch-state: var(--ğŸŒ€switch-state--checked-hover);
          }
        }
      }

      &:where(:active) {
        --ğŸŒ€switch-state: var(--ğŸŒ€switch-state--pressed);

        /* https://css-tricks.com/various-methods-for-expanding-a-box-while-preserving-the-border-radius/#aa-changing-scale */
        --ğŸ¥switch-thumb-transform: scaleX(var(--âœ¨pressed-scaleX));
        --ğŸ¥switch-thumb-radius: calc(
            var(--âœ¨radius) / var(--âœ¨pressed-scaleX)
          ) /
          var(--âœ¨radius);
      }

      &:where(:disabled, [aria-disabled="true"]) {
        --ğŸŒ€switch-state: var(--ğŸŒ€switch-state--disabled);
        --ğŸ¥switch-thumb-color: var(--stratakit-color-icon-neutral-disabled);
        cursor: not-allowed;
        -webkit-tap-highlight-color: transparent;

        &::after {
          box-shadow: none;
        }
      }
    }

    @layer base.ğŸŒ€ {
      /* Cyclic toggles for default/hover/pressed/checked/checked+hover states. See https://kizu.dev/cyclic-toggles/ */
      --ğŸŒ€switch-state: var(--ğŸŒ€switch-state--default);
      --ğŸŒ€switch-state--default: var(--ğŸŒ€switch-state,);
      --ğŸŒ€switch-state--hover: var(--ğŸŒ€switch-state,);
      --ğŸŒ€switch-state--pressed: var(--ğŸŒ€switch-state,);
      --ğŸŒ€switch-state--checked: var(--ğŸŒ€switch-state,);
      --ğŸŒ€switch-state--checked-hover: var(--ğŸŒ€switch-state,);
      --ğŸŒ€switch-state--disabled: var(--ğŸŒ€switch-state,);
    }
  }

  @media (forced-colors: active) {
    .stratakit-switch {
      border-color: CanvasText;
      --ğŸ¥switch-thumb-color: CanvasText;

      &:where(:checked, [aria-checked="true"]) {
        background-color: SelectedItem;
        --ğŸ¥switch-thumb-color: SelectedItemText;
      }

      &:where(:disabled, [aria-disabled="true"]) {
        background-color: Canvas;
        border-color: GrayText;
        --ğŸ¥switch-thumb-color: GrayText;
      }
    }
  }
}
