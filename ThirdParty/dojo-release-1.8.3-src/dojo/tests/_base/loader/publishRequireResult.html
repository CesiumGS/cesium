<html>
<head>
	<script type="text/javascript">
		var publishing= location.query!="?do-not-publish";
		if(!publishing){
			var dojoConfig = {
				publishRequireResult:0
			}
		}
	</script>
	<script type="text/javascript" src="../../../dojo.js"></script>
	<script type="text/javascript">
	    dojo.setObject("dojo.tests._base.loader.pub1", "do-not-mess-with-me");
		dojo.require("dojo.tests._base.loader.pub1");
		dojo.require("dojo.tests._base.loader.pub2");
		require(["doh", "dojo/has"], function(doh, has) {
			doh.register("config-publish-require-result", function(t){
				t.is(dojo.tests._base.loader.pub1, "do-not-mess-with-me");
				if(publishing){
				    t.t(has("config-publishRequireResult"));
					t.is(dojo.tests._base.loader.pub2.status, "ok");
				}else{
				    t.t(!has("config-publishRequireResult"));
					t.t(!dojo.config.publishRequireResult);
					t.is(dojo.tests._base.loader.pub2.status, undefined);
				}
			});
			doh.runOnLoad();
		});
	</script>
</head>
<body>
</body>
</html>
